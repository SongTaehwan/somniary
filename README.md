# Somniary

SwiftUI ê¸°ë°˜ iOS ì• í”Œë¦¬ì¼€ì´ì…˜

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ ì„¤ê³„ êµ¬ì¡°

### í•µì‹¬ ì›ì¹™

- **Clean Architecture + Hexagonal (Ports & Adapters) Architecture**
- **Anti-corruption Layer (ACL)**: ì»¨í…ìŠ¤íŠ¸ ê°„ ê²½ê³„ ë³´í˜¸
- **Repository & Data Source ë¶„ë¦¬**: ëª…í™•í•œ Data Layer ì±…ì„ ë¶„ë¦¬

---

## ğŸ“ ê³„ì¸µ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Presentation Layer                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Coordinator  â”‚  â”‚  ViewModel   â”‚  â”‚    Views     â”‚      â”‚
â”‚  â”‚   (Flow)     â”‚â”€â”€â”‚   (State)    â”‚â”€â”€â”‚     (UI)     â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Domain Layer                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   Entities   â”‚  â”‚   UseCases   â”‚  â”‚    Errors      â”‚    â”‚
â”‚  â”‚  (Models)    â”‚  â”‚  (Logic)     â”‚  â”‚ (SomniaryError)â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Data Layer                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚    Repository        â”‚       â”‚   Domain Mapping     â”‚   â”‚
â”‚  â”‚  (AuthReposable)     â”‚â—„â”€â”€â”€â”€â”€â”€â”‚   Error Mapping      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Infrastructure Layer                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   Network    â”‚  â”‚   Storage    â”‚  â”‚  External    â”‚      â”‚
â”‚  â”‚ (HTTP Client)â”‚  â”‚  (Keychain)  â”‚  â”‚ (Apple Auth) â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‚ ë””ë ‰í† ë¦¬ êµ¬ì¡° & ì±…ì„

```
Somniary/
â”‚
â”œâ”€â”€ ğŸ¯ Modules/                    # ê¸°ëŠ¥ ëª¨ë“ˆ (Feature Modules)
â”‚   â”œâ”€â”€ Login/
â”‚   â”‚   â”œâ”€â”€ Coordinator/          # í™”ë©´ ì „í™˜ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ ViewModel/            # ìƒíƒœ ê´€ë¦¬ & ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì—°ê²°
â”‚   â”‚   â”œâ”€â”€ Views/                # UI ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ Reducer/              # ìƒíƒœ ë³€ê²½ ìˆœìˆ˜ í•¨ìˆ˜
â”‚   â”‚   â”œâ”€â”€ Effect/               # Side Effect ì‹¤í–‰
â”‚   â”‚   â”œâ”€â”€ Domain/               # ëª¨ë“ˆë³„ ë„ë©”ì¸ ì—”í‹°í‹° & ì—ëŸ¬
â”‚   â”‚   â””â”€â”€ DataSources/          # Repository êµ¬í˜„ì²´
â”‚   â”‚
â”‚   â”œâ”€â”€ Settings/
â”‚   â””â”€â”€ TabBar/
â”‚
â”œâ”€â”€ ğŸ§© Domain/                     # ê³µí†µ ë„ë©”ì¸ ë ˆì´ì–´
â”‚   â”œâ”€â”€ Entities/                 # ë„ë©”ì¸ ì—”í‹°í‹°
â”‚   â”œâ”€â”€ UseCases/                 # ë¹„ì¦ˆë‹ˆìŠ¤ ìœ ìŠ¤ì¼€ì´ìŠ¤
â”‚   â””â”€â”€ Errors/                   # ë„ë©”ì¸ ì—ëŸ¬ ì •ì˜
â”‚       â”œâ”€â”€ SomniaryError.swift   # ë²”ìš© ì—ëŸ¬ êµ¬ì¡°
â”‚       â”œâ”€â”€ DomainError.swift     # ì—ëŸ¬ í”„ë¡œí† ì½œ
â”‚       â””â”€â”€ ErrorContext.swift    # ì—ëŸ¬ ì»¨í…ìŠ¤íŠ¸ ì •ë³´
â”‚
â”œâ”€â”€ ğŸŒ Network/                    # Infrastructure - ë„¤íŠ¸ì›Œí¬
â”‚   â”œâ”€â”€ Interfaces/               # í”„ë¡œí† ì½œ (Ports)
â”‚   â”‚   â”œâ”€â”€ SomniaryNetworking.swift
â”‚   â”‚   â””â”€â”€ Endpoint.swift
â”‚   â”œâ”€â”€ Endpoints/                # API ì—”ë“œí¬ì¸íŠ¸ ì •ì˜
â”‚   â”œâ”€â”€ Entities/                 # ë„¤íŠ¸ì›Œí¬ ì‘ë‹µ DTO
â”‚   â”œâ”€â”€ SomniaryHTTPClient.swift  # HTTP í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„
â”‚   â””â”€â”€ TransportError.swift      # ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬
â”‚
â”œâ”€â”€ ğŸ§° Common/                     # ê³µí†µ ìœ í‹¸ë¦¬í‹°
â”‚   â”œâ”€â”€ TokenRepository/          # í† í° ê´€ë¦¬
â”‚   â”œâ”€â”€ KeychainStorage.swift     # Keychain ì €ì¥ì†Œ
â”‚   â”œâ”€â”€ LocalStorage.swift        # UserDefaults ì €ì¥ì†Œ
â”‚   â””â”€â”€ ViewModelType.swift       # ViewModel í”„ë¡œí† ì½œ
â”‚
â”œâ”€â”€ ğŸ§­ Coordinator/                # í™”ë©´ ì „í™˜ íŒ¨í„´
â”‚   â”œâ”€â”€ Coordinator.swift         # ê¸°ë³¸ í”„ë¡œí† ì½œ
â”‚   â”œâ”€â”€ FlowCoordinator.swift     # Flow ê´€ë¦¬
â”‚   â””â”€â”€ NavigationFlowView.swift  # SwiftUI í†µí•©
â”‚
â”œâ”€â”€ ğŸ¨ SharedUI/                   # ê³µí†µ UI ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ BaseButton.swift
â”‚   â”œâ”€â”€ TextInput.swift
â”‚   â””â”€â”€ Modifiers/
â”‚
â””â”€â”€ ğŸ”§ Helpers/                    # í™•ì¥ & ìœ í‹¸ë¦¬í‹°
    â”œâ”€â”€ Array+Extensions.swift
    â”œâ”€â”€ Publisher+Extensions.swift
    â””â”€â”€ Result+Extensions.swift
```

---

## ğŸ”„ ì˜ì¡´ì„± íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Dependency Rule                          â”‚
â”‚                                                             â”‚
â”‚   Presentation  â”€â”€â–º  Domain  â”€â”€â–º  Data  â”€â”€â–º  Infrastructure â”‚
â”‚                                                             â”‚
â”‚       ì—­ë°©í–¥ ì˜ì¡´ ê¸ˆì§€ (Dependency Inversion Principle)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### êµ¬ì²´ì  íë¦„ ì˜ˆì‹œ (ë¡œê·¸ì¸)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LoginView   â”‚â”€â”€â”€â”€â”€â–ºâ”‚ LoginViewModel â”‚â”€â”€â”€â”€â”€â–ºâ”‚ AuthReposable â”‚â”€â”€â”€â”€â”€â–ºâ”‚ SomniaryHTTP  â”‚
â”‚   (SwiftUI)  â”‚      â”‚     (State)    â”‚      â”‚   (Protocol)  â”‚      â”‚    Client     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ LoginEffectPlan â”‚ â—„â”€â”€â”€ Side Effect ë¶„ë¦¬
                      â”‚  (Async Tasks)  â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ­ í•µì‹¬ íŒ¨í„´

### 1. MVI (Model-View-Intent) + Effect Pattern

í”„ë ˆì  í…Œì´ì…˜ ë ˆì´ì–´ëŠ” **MVI ì•„í‚¤í…ì²˜**ë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          MVI Cycle                                â”‚
â”‚                                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   Intent    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚   â”‚   View    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  Reducer   â”‚                        â”‚
â”‚   â”‚ (SwiftUI) â”‚             â”‚   (Pure)   â”‚                        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚        â–²                      â”‚         â”‚                         â”‚
â”‚        â”‚                      â”‚         â”‚                         â”‚
â”‚      render          New Stateâ”‚         â”‚ Effect Plan ìƒì„±         â”‚
â”‚        â”‚                      â”‚         â”‚                         â”‚
â”‚        â”‚                      â–¼         â–¼                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚   â”‚  State   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”‚   ViewModel       â”‚                      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   í• ë‹¹   â”‚ (Effect ë¶„ë¥˜/ì²˜ë¦¬)  â”‚                      â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                              â”‚         â”‚                          â”‚
â”‚                     Navigation/        â”‚                          â”‚
â”‚                     UI Effect     API Effect                      â”‚
â”‚                              â”‚         â”‚                          â”‚
â”‚                              â–¼         â–¼                          â”‚
â”‚                        Coordinator  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚                        / UIEvent    â”‚   Executor   â”‚              â”‚
â”‚                                     â”‚ (API, ë¡œê¹… ë“±) â”‚              â”‚
â”‚                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                            â”‚                      â”‚
â”‚                                            â”‚                      â”‚
â”‚                                     ê²°ê³¼ë¥¼ Intentë¡œ í™˜ë¥˜             â”‚
â”‚                                            â”‚                      â”‚
â”‚                                            â””â”€â”€â”€â”€â”€â”€â–ºIntent (ì¬ìˆœí™˜)  â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### MVI êµ¬ì„± ìš”ì†Œ

| ìš”ì†Œ         | ì—­í•                                              | êµ¬í˜„ ì˜ˆì‹œ                                |
| ------------ | ------------------------------------------------ | ---------------------------------------- |
| **Model**    | ë¶ˆë³€ ìƒíƒœ                                        | `LoginState`                             |
| **View**     | UI ë Œë”ë§ & Intent ë°œí–‰                          | `LoginView`                              |
| **Intent**   | ì‚¬ìš©ì/ì‹œìŠ¤í…œ ì´ë²¤íŠ¸                             | `LoginIntent` (User, System, Navigation) |
| **Reducer**  | ìˆœìˆ˜ í•¨ìˆ˜: `(State, Intent) â†’ (State, [Effect])` | `combinedReducer`                        |
| **Effect**   | Side Effect ë°ì´í„°                               | `LoginEffectPlan`                        |
| **Executor** | Effect ì‹¤í–‰ê¸°                                    | `LoginExecutor`                          |

#### Intent ìœ í˜•

IntentëŠ” ì‹œìŠ¤í…œì—ì„œ ë°œìƒí•˜ëŠ” ëª¨ë“  ì´ë²¤íŠ¸ë¥¼ í‘œí˜„í•˜ë©°, ì¶œì²˜ì— ë”°ë¼ ë¶„ë¥˜ë©ë‹ˆë‹¤.

| ìœ í˜•                  | ì—­í•                | ì˜ˆì‹œ                                                       |
| --------------------- | ------------------ | ---------------------------------------------------------- |
| **User Intent**       | ì‚¬ìš©ì ì¸í„°ë™ì…˜    | `.emailChanged()`, `.submitLogin()`, `.signUpTapped()`     |
| **Lifecycle Intent**  | View ìƒëª…ì£¼ê¸°      | `.appeared`, `.disappeared`                                |
| **System External**   | ì™¸ë¶€ ì‹œìŠ¤í…œ ì´ë²¤íŠ¸ | `.appleLoginRequest`, `.networkReachable()`, `.deepLink()` |
| **System Internal**   | Effect ì‹¤í–‰ ê²°ê³¼   | `.loginResponse()`, `.verifyResponse()`                    |
| **Navigation Intent** | í™”ë©´ ì „í™˜ ìš”ì²­     | `.routeToHome`, `.routeToSignUp`                           |

```swift
// LoginIntent.swift - Intent ê³„ì¸µ êµ¬ì¡°
enum LoginIntent {
    case user(UserIntent)                    // ì‚¬ìš©ì ì•¡ì…˜
    case lifecycle(LifecycleIntent)          // View ìƒëª…ì£¼ê¸°
    case systemExtenral(SystemExtenralIntent) // ì™¸ë¶€ ì‹œìŠ¤í…œ
    case systemInternal(SystemInternalIntent) // Effect ê²°ê³¼
    case navigation(NavigationIntent)         // ë„¤ë¹„ê²Œì´ì…˜
}

// ê° IntentëŠ” ëª…í™•í•œ ì¶œì²˜ë¥¼ ê°€ì§
enum UserIntent {
    case emailChanged(String)
    case submitLogin
    // ...
}

enum SystemInternalIntent {
    case loginResponse(Result<VoidResponse, AuthError>)
    case verifyResponse(Result<TokenEntity, AuthError>)
    // ...
}
```

#### ì‹¤ì œ íë¦„ ì˜ˆì‹œ

```swift
// 1. Userê°€ ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­
View: Button("ë¡œê·¸ì¸") { viewModel.send(.user(.submitLogin)) }

// 2. Reducerê°€ ìˆœìˆ˜ í•¨ìˆ˜ë¡œ ìƒˆë¡œìš´ ìƒíƒœì™€ Effect ë°˜í™˜
Reducer: (oldState, .user(.submitLogin))
    â†’ (newState.isLoading = true,
       [.verify(email, otp, requestId)])

// 3. Executorê°€ Effect ì‹¤í–‰ (API í˜¸ì¶œ)
Executor: .verify(...)
    â†’ Repository.verify(...)
    â†’ Intent í™˜ë¥˜: .systemInternal(.verifyResponse(result))

// 4. ë‹¤ì‹œ Reducerë¡œ ìˆœí™˜
Reducer: (state, .systemInternal(.verifyResponse(.success(token))))
    â†’ (state, [.storeToken(token), .route(.navigateHome)])
```

#### íŠ¹ì§•

- **ë‹¨ë°©í–¥ ë°ì´í„° íë¦„**: View â†’ Intent â†’ Reducer â†’ State â†’ View
- **ìˆœìˆ˜ í•¨ìˆ˜ Reducer**: í…ŒìŠ¤íŠ¸ ìš©ì´, ì˜ˆì¸¡ ê°€ëŠ¥
- **Side Effect ê²©ë¦¬**: Effectë¡œ ë¶„ë¦¬í•˜ì—¬ ì¶”ì  ê°€ëŠ¥
- **ì‹œê°„ ì—¬í–‰ ë””ë²„ê¹…**: ëª¨ë“  Intentì™€ State ë³€í™” ê¸°ë¡ ê°€ëŠ¥

---

### 2. Coordinator Pattern

```swift
FlowCoordinator
  â””â”€â”€ í™”ë©´ ì „í™˜ ë¡œì§ì„ ViewModelì—ì„œ ë¶„ë¦¬
  â””â”€â”€ ì¤‘ì•™í™”ëœ ë„¤ë¹„ê²Œì´ì…˜ ê´€ë¦¬
```

---

### 3. Repository Pattern

```swift
Protocol (AuthReposable)           # Domain Layer
    â†“ implements
Repository (RemoteAuthRepository)  # Data Layer
    â†“ uses
Data Source (SomniaryHTTPClient)   # Infrastructure Layer
```

---

### 4. Error Mapping (Anti-corruption Layer)

ACL íŒ¨í„´ì„ í†µí•´ ì¸í”„ë¼ ê³„ì¸µì˜ ì—ëŸ¬ë¥¼ ë„ë©”ì¸ ì—ëŸ¬ë¡œ ë³€í™˜í•˜ì—¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë³´í˜¸í•©ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Error Flow & Mapping                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Infrastructure Layer
â”œâ”€ TransportError              # ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ (HTTP, ì—°ê²° ë“±)
â””â”€ Data Source Error           # ë””ì½”ë”©, ë³€í™˜ ì—ëŸ¬
         â”‚
         â”‚ Repositoryê°€ ACL ì—­í•  ìˆ˜í–‰
         â–¼
Domain Layer
â””â”€ DomainError                 # ë¹„ì¦ˆë‹ˆìŠ¤ ì»¨í…ìŠ¤íŠ¸ ì—ëŸ¬
   (SomniaryError)             # - AuthError
                               # - UserError ë“±
         â”‚
         â”‚ ViewModel/Viewê°€ ì‚¬ìš©ì ì¹œí™”ì ìœ¼ë¡œ ë³€í™˜
         â–¼
Presentation Layer
â””â”€ User Message                # "ì´ë©”ì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”"
```

#### Repositoryì˜ ACL ì—­í• 

```swift
// RemoteAuthRepository.swift
func verify(email: String, otpCode: String) async throws -> TokenEntity {
    let result = await client.request(.verify(email: email, otpCode: otpCode))

    switch result {
    case .success(let response):
        do {
            // Data Source Error ê°€ëŠ¥ (ë””ì½”ë”© ì‹¤íŒ¨ ë“±)
            let data = try JSONDecoder().decode(NetAuth.Verify.Response.self,
                                                  from: response.body)
            return TokenEntity(accessToken: data.accessToken,
                              refreshToken: data.refreshToken)
        } catch {
            // ë””ì½”ë”© ì—ëŸ¬ â†’ Domain Error ë§¤í•‘
            throw mapToDomainError(error)
        }
    case .failure(let transportError):
        // Transport Error â†’ Domain Error ë§¤í•‘
        throw mapToDomainError(transportError)
    }
}

private func mapToDomainError(_ error: Error) -> DomainError {
    // Infrastructure ì—ëŸ¬ë¥¼ Domain ì—ëŸ¬ë¡œ ë³€í™˜
    // ì™¸ë¶€ ì‹œìŠ¤í…œ ë³€ê²½ì´ ë„ë©”ì¸ì— ì˜í–¥ì„ ì£¼ì§€ ì•Šë„ë¡ ë³´í˜¸
}
```

#### ì—ëŸ¬ ìœ í˜•ë³„ ì²˜ë¦¬

| ê³„ì¸µ               | ì—ëŸ¬ íƒ€ì…              | ì±…ì„                 | ì˜ˆì‹œ                                    |
| ------------------ | ---------------------- | -------------------- | --------------------------------------- |
| **Infrastructure** | `TransportError`       | HTTP/ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬   | `.networkFailure`, `.unauthorized(401)` |
| **Data**           | Decoding/Parsing Error | ë°ì´í„° ë³€í™˜ ì‹¤íŒ¨     | `DecodingError`, `DateParsingError`     |
| **Domain**         | `DomainError`          | ë¹„ì¦ˆë‹ˆìŠ¤ ì—ëŸ¬        | `AuthError.invalidCredentials`          |
| **Presentation**   | User Message           | ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€ | "ë¡œê·¸ì¸ ì •ë³´ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤"       |

#### ACLì˜ ì¥ì 

- **ì™¸ë¶€ ì˜ì¡´ì„± ê²©ë¦¬**: ë„¤íŠ¸ì›Œí¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë³€ê²½ì´ ë„ë©”ì¸ì— ì˜í–¥ ì—†ìŒ
- **ëª…í™•í•œ ì—ëŸ¬ ì»¨í…ìŠ¤íŠ¸**: ë¹„ì¦ˆë‹ˆìŠ¤ ê´€ì ì˜ ì—ëŸ¬ í‘œí˜„
- **í…ŒìŠ¤íŠ¸ ìš©ì´ì„±**: ë„ë©”ì¸ ë ˆì´ì–´ëŠ” Infrastructure ì—ëŸ¬ë¥¼ ëª°ë¼ë„ ë¨
